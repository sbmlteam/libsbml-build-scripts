# Creating a Python binary from the Python source and uploading them to PyPI

* create a working directory outside of Dropbox e.g. ~/work
* copy the newly generated "full" Python source archive generated by `python-create-standalone`, 'out/python-libsbml-experimental-<ver>.tar.gz` to the work directory
* unpack the archive `tar xf python-libsbml-experimental-<ver>.tar.gz`
* cd into your newly unpacked archive
* build with `python setup.py build` using default Python and be happy when it works
* create Mac wheel with `python setup.py bdist_wheel`

DO NOT register release with PyPI `python setup.py register` API has been deprecated, INSTEAD simply upload the src and Mac wheel with `twine` and PyPI extracts the release metadata (hopefully):

* `twine upload python-libsbml-experimental-<ver>.tar.gz`
* `twine upload dist\python_libsbml_experimental-<ver>-cp27-cp27m- macosx_10_12_intel.whl`
* delete unpacked archive

Note if you encounter any distutils/setuptool errors with the wheel creation take a look at the setup.py file and make sure the distutils import looks like this:

```
try:
  from setuptools import setup, Extension, Command
except ImportError:
  from distutils.core import setup, Extension
```

# Creating an Anaconda Python binary from the Python source and uploading to conda cloud

* Unpack a new copy of the Python source archive `tar xf python-libsbml-experimental-<ver>.tar.gz`
* cd into your newly unpacked archive

Note this may not be necessary, but in any case, fire up your editor `nano setup.py` and look for this section of code

```
try:
  from setuptools import setup, Extension, Command
except ImportError:
  from distutils.core import setup, Extension
  
```

simply add the following lines:

```
try:
    import distutils.command.bdist_conda
except:
    pass  

```

Next we use Anaconda (not native as before) to build the Anaconda binaries. Anaconda Python lives in ~/anaconda2 so we need to call its Python binary, assuming we are in ~/work/<archive>

* run `../../anaconda2/bin/python setup.py bdist_conda` this will compile the Ananconda package
* Once you have a Conda package we need to upload it to the Anaconda cloud. 
* Log in to the Anaconda cloud first id you need to `../anaconda2/bin/anaconda login`
* upload with `../anaconda2/bin/anaconda upload --user SBMLTeam /Users/frank/anaconda2/conda-bld/osx-64/python-libsbml-experimental-<ver>-py27_0.tar.bz2`

UPDATE 5.17.0: OSX ANACONDA 
Once the source package has been uploaded to PyPI we can create all Anaconda packages:

 cd ~\Developemt
 ./create_conda_xxx.sh python-libsbml-experimental
 ./create_conda_xxx.sh python-libsbml

and then upload with 

 ../anaconda2/bin/anaconda upload --user SBMLTeam /Users/frank/anaconda2/conda-bld/osx-64/python-libsbml-experimental-<ver>-<pyver>.tar.bz2`
 ../anaconda2/bin/anaconda upload --user SBMLTeam /Users/frank/anaconda2/conda-bld/osx-64/python-libsbml-<ver>-<pyver>_0.tar.bz2`
 
UPDATE 5.17.0: WINDOWS binaries

connect to delay

update the subversion repositories to the release version

 libsbml-experimental-src-32
 libsbml-experimental-src-64 

Next go to the python packaging tools, check for modifications in the setup.py and cmake files (new packages):

 cd c:\Development\libsbml-experimental-src-64\dev\utilities\build-python\
 run build_all.bat

FUTURE

try:
  from setuptools import setup, Extension
  try: 
    import distutils.command.bdist_conda
  except: 
    pass
except:
  from distutils.core import setup, Extension
  try: 
    import distutils.command.bdist_conda
  except: 
    pass
    


-DUSE_RENDER

